cmake_minimum_required(VERSION 2.8.2)

project(zlib-download NONE)
include(ExternalProject)

set(EP_SOURCE_DIR ${CMAKE_BINARY_DIR}/zlib-src)
set(EP_BINARY_DIR ${CMAKE_BINARY_DIR}/zlib-build)
set(EP_INSTALL_DIR ${CMAKE_BINARY_DIR}/zlib-install)

set(zlib_GIT_REPOSITORY "https://github.com/commontk/zlib.git")
set(zlib_GIT_TAG "66a753054b356da85e1838a081aa94287226823e")

ExternalProject_Add(zlib
  GIT_REPOSITORY "${zlib_GIT_REPOSITORY}"
  GIT_TAG "${zlib_GIT_TAG}"
  SOURCE_DIR ${EP_SOURCE_DIR}
  BINARY_DIR ${EP_BINARY_DIR}
  INSTALL_DIR ${EP_INSTALL_DIR}
  CMAKE_CACHE_ARGS
    ## CXX should not be needed, but it a cmake default test
    -DCMAKE_CXX_COMPILER:FILEPATH=${CMAKE_CXX_COMPILER}
    -DCMAKE_C_COMPILER:FILEPATH=${CMAKE_C_COMPILER}
    #-DCMAKE_C_FLAGS:STRING=${ep_common_c_flags}
    #-DZLIB_MANGLE_PREFIX:STRING=xeus_zlib_
    -DCMAKE_INSTALL_PREFIX:PATH=<INSTALL_DIR>
  )

set(zlib_DIR ${EP_INSTALL_DIR})
set(ZLIB_ROOT ${zlib_DIR})
set(ZLIB_INCLUDE_DIR ${zlib_DIR}/include)
if(WIN32)
  set(ZLIB_LIBRARY ${zlib_DIR}/lib/zlib.lib)
else()
  set(ZLIB_LIBRARY ${zlib_DIR}/lib/libzlib.a)
endif()

